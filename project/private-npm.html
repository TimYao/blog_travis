<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>介绍 | 知识文章</title>
    <meta name="generator" content="VuePress 1.4.1">
    
    <meta name="description" content="This is a blog.">
    <link rel="preload" href="/blog/assets/css/0.styles.eea3ff88.css" as="style"><link rel="preload" href="/blog/assets/js/app.a3423334.js" as="script"><link rel="preload" href="/blog/assets/js/2.a973bc12.js" as="script"><link rel="preload" href="/blog/assets/js/22.2aefa173.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.874ad3ec.js"><link rel="prefetch" href="/blog/assets/js/11.0711065f.js"><link rel="prefetch" href="/blog/assets/js/12.c40d93da.js"><link rel="prefetch" href="/blog/assets/js/13.da43d7f3.js"><link rel="prefetch" href="/blog/assets/js/14.5f50c20e.js"><link rel="prefetch" href="/blog/assets/js/15.d82d9cf0.js"><link rel="prefetch" href="/blog/assets/js/16.ff02c56f.js"><link rel="prefetch" href="/blog/assets/js/17.902c3621.js"><link rel="prefetch" href="/blog/assets/js/18.690ad6d6.js"><link rel="prefetch" href="/blog/assets/js/19.e8feab27.js"><link rel="prefetch" href="/blog/assets/js/20.1d7fcf1c.js"><link rel="prefetch" href="/blog/assets/js/21.16c4ed2a.js"><link rel="prefetch" href="/blog/assets/js/23.4e5640f3.js"><link rel="prefetch" href="/blog/assets/js/24.ba1b495a.js"><link rel="prefetch" href="/blog/assets/js/25.e8666563.js"><link rel="prefetch" href="/blog/assets/js/26.5787142e.js"><link rel="prefetch" href="/blog/assets/js/27.b2722766.js"><link rel="prefetch" href="/blog/assets/js/28.5aa26eb0.js"><link rel="prefetch" href="/blog/assets/js/29.3d2624e8.js"><link rel="prefetch" href="/blog/assets/js/3.f86f4f75.js"><link rel="prefetch" href="/blog/assets/js/30.29661336.js"><link rel="prefetch" href="/blog/assets/js/31.447afcaa.js"><link rel="prefetch" href="/blog/assets/js/32.c2bd8e9a.js"><link rel="prefetch" href="/blog/assets/js/33.797423e5.js"><link rel="prefetch" href="/blog/assets/js/34.ee1d27eb.js"><link rel="prefetch" href="/blog/assets/js/35.89ff95b9.js"><link rel="prefetch" href="/blog/assets/js/36.a6567a31.js"><link rel="prefetch" href="/blog/assets/js/37.e0cd8c86.js"><link rel="prefetch" href="/blog/assets/js/38.4ca67963.js"><link rel="prefetch" href="/blog/assets/js/39.4bec9a8a.js"><link rel="prefetch" href="/blog/assets/js/4.221a248a.js"><link rel="prefetch" href="/blog/assets/js/40.6b72df98.js"><link rel="prefetch" href="/blog/assets/js/41.91a0c3cd.js"><link rel="prefetch" href="/blog/assets/js/42.c495687d.js"><link rel="prefetch" href="/blog/assets/js/43.fc90ceb9.js"><link rel="prefetch" href="/blog/assets/js/44.5da0fdd6.js"><link rel="prefetch" href="/blog/assets/js/5.d9260729.js"><link rel="prefetch" href="/blog/assets/js/6.e532ac18.js"><link rel="prefetch" href="/blog/assets/js/7.d43e6edf.js"><link rel="prefetch" href="/blog/assets/js/8.0d7bba76.js"><link rel="prefetch" href="/blog/assets/js/9.d2e1456d.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.eea3ff88.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">知识文章</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/TimYao" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/TimYao" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/blog/jsdoc.html" class="sidebar-link">JS</a></li><li><a href="/blog/all.html" class="sidebar-link">Html/Css</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端框架</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/blog/test.html" class="sidebar-link">测试</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>构建工具</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>服务端</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/blog/replease.html" class="sidebar-link">发布上线</a></li><li><a href="/blog/expand.html" class="sidebar-link">扩展知识</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>源码分析</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/blog/resource.html" class="sidebar-link">资料</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>项目实践</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/project/monitor.html" class="sidebar-link">前端监控</a></li><li><a href="/blog/project/ui-component.html" class="sidebar-link">组件开发</a></li><li><a href="/blog/project/private-npm.html" class="active sidebar-link">私服搭建</a></li><li><a href="/blog/project/wokoo.html" class="sidebar-link">wokoo浏览器插架</a></li></ul></section></li><li><a href="/blog/sf.html" class="sidebar-link">算法学习</a></li><li><a href="/blog/408.html" class="sidebar-link">计算机408课本</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="介绍"><a href="#介绍" class="header-anchor">#</a> 介绍</h2> <p>npm: node包管理器</p> <p>nrm: node资源管理器，管理多资源库之间灵活切换</p> <p>nvm: node版本管理</p> <p>cnpm: 内地提供的node包管理器</p> <p>npm资源的切换可以通过</p> <div class="language- extra-class"><pre><code>  npm config set registry https://registry.npm.taobao.org/
</code></pre></div><p>nrm方式管理</p> <div class="language- extra-class"><pre><code>  npm i -g nrm

  查看了已有的资源库
  nrm ls

  当前正使用的资源库
  nrm current

  添加资源库
  nrm add &lt;registry&gt; &lt;url&gt;

  //比如添加自己公司的私有npm源，源地址：http://192.168.28.11:3000/repository/npm-public/,源名为：company(任意取名称，作为自己公司的私有npm源的名称

  切换使用资源库
  nrm use &lt;registry&gt;
  nrm use taobao

  删除资源库
  nrm del &lt;registry&gt;

  测试资源库响应时间
  nrm test &lt;registry&gt;
</code></pre></div><p>cnpm运用</p> <div class="language- extra-class"><pre><code>  npm i -g cnpm

  cnpm -v

  cnpm config set registry &lt;url&gt;
</code></pre></div><h2 id="npm知识点"><a href="#npm知识点" class="header-anchor">#</a> npm知识点</h2> <p>npm包方式是一种灵活的管理包方式，可以将各种模块功能独立话开发，通过服务管理这些包，需求方通过安装下载包以聚合入项目开发，这种方式是流行方式之一</p> <ul><li><p><strong>package.json</strong></p> <p>对于记录包中的各种信息，例如版本version，名字name，命令bin，描述description，依赖包dependencies，开发依赖包devDependencies，脚本执行scripts</p> <p><strong>dependencies与devDependencies</strong></p> <div class="language- extra-class"><pre><code>devDependencies开发模式下记录依赖包；
npm install -D xxxx

dependencies生成环境下记录依赖包；
npm install -S xxxx
</code></pre></div><p><strong>bin</strong></p> <p>指定了该包中提供的执行命令所映射的执行文件位置，当在全局安装时会在全局路径/usr/local/bin产生对应的命令链接；若项目下安装会产生./node_modules/bin产生对应的命令链接，在对应模式下的bin下产生配置的vm2文件，并最终执行对应的文件</p> <div class="language- extra-class"><pre><code>&quot;bin&quot;: {
  &quot;vm2&quot;: &quot;./bin/vm2&quot;
}
</code></pre></div><p><strong>main</strong></p> <p>包的入口模块文件，当需要通过require导入该包，此时对应映射的文件main指定的文件</p></li> <li><p><strong>npm &lt;command&gt;</strong></p> <ul><li><strong>npm init</strong></li></ul> <p>创建包中的package.json文件；创建方式有默认方式与自定义方式；自定义方式通过建立.npm-init.js文件，内部进行相关配置，并通过npm config set init-module .npm-init.js切换为自定义方式触发</p> <ul><li><strong>2. npm scripts</strong></li></ul> <p>scripts为指定包中运行的命令，在npm run test方式下，通过npm run启动了一个子shell来完成执行的脚本命令，也就是说，若命令对应为node test.js则当开启一个shell后，该命令会在shell中完成，因此任何可以在shell中执行的命令都可以在此定义；另外在全局模式下，模块安装在全局目录下/usr/local/lib/node_modules,将/usr/local/.bin加入到PATH下，当项目目录下./node_modules/.bin将会在script命令执行时加入到PATH中，执行结束后退出</p> <div class="language- extra-class"><pre><code>&quot;scripts&quot;: {
  &quot;test&quot;: &quot;test.js&quot;
  &quot;build&quot;: &quot;tsc&quot;,
}
</code></pre></div><p>钩子生命周期npm 脚本有两个钩子，pre 和 post;当我们执行start脚本时候，start 的钩子就是 prestart 和 poststart,通过钩子有什么用，在实际开发中，我们可以做一些准备或者清理工作</p> <div class="language- extra-class"><pre><code>&quot;clean&quot;: &quot;rimraf ./dist &amp;&amp; mkdir dist&quot;,
&quot;prebuild&quot;: &quot;npm run clean&quot;,
&quot;build&quot;: &quot;cross-env NODE_ENV=production webpack&quot;
</code></pre></div><p><font color="#8C8C8C" size="3">注意：钩子好用，但是不可乱用，举个开发过程中遇到的坑，有一次想设置运行时的环境变量，当时想优雅一点，就在 prestart 里面设置了一个环境变量，但是在项目 start 的时候，无法拿到设置的环境变量，因为 script 的属性运行的时候都会新启动一个 shell，所以在 prestart中设置的环境变量只对应了那个shell的运行时</font></p></li> <li><p><strong>env环境变量</strong></p> <p>我们在执行 npm run 脚本时候, npm 会设置一些特殊的env环境变量。其中package.json中的所有字段，都会被设置为以npm_package_开头的环境变量。看个简单的例子</p> <div class="language- extra-class"><pre><code>{
  &quot;name&quot;: &quot;npm-demo&quot;,
  &quot;version&quot;: &quot;1.0.0&quot;,
  &quot;script&quot;: {
    &quot;build&quot;: &quot;webpack --mode=production&quot;
  },
  &quot;files&quot;: [&quot;src&quot;]
}
</code></pre></div><p>可以得到 npm_package_name、npm_package_version、npm_package_script_build、npm_package_files_0等变量。注意上面 package.json 中对象和数组中每个字段都会有对应的环境变量</p> <p>同时，npm 相关的所有配置也会被设置为以npm_config_开头的环境变量。此外，还会设置一个比较特殊的环境变量npm_lifecycle_event，表示正在运行的脚本名称。比如执行npm run serve 的时候，process.env.npm_lifecycle_event值为serve，通过判断这个变量，可以将一个脚本使用在不同的npm scripts中。这里还要提一下上面说的钩子，npm_lifecycle_event可以和钩子配合使用，利用这个变量，在同一个脚本文件里面，为不同的 npm scripts 命令编写代码</p> <p><font color="#8C8C8C" size="3">强调：这些环境变量只能在 npm run 的脚本执行环境内拿到，正常执行的 node 脚本是获取不到的。所以，不能直接通过 env $npm_package_name 的形式访问，但可以在 scripts 中定义脚本&quot;scripts&quot;: {&quot;bundle&quot;: &quot;echo $npm_package_name&quot;}来访问</font></p></li> <li><p><strong>脚本中的参数</strong></p> <p>node 处理 scripts 中的参数，除了属性后面的第一个命令，以空格分割的任何字符串(除特别shell语法)都是参数，并且都能通过 process.argv 属性访问</p> <p>process.argv 属性返回一个数组，数组包含了启动 node 进程时的命令行参数。第一个元素为启动 node 进程的可执行文件的绝对路径名 process.execPath,第二个元素为当前执行的 jacascript 文件路径。剩余的元素为其他命令行参数</p> <div class="language- extra-class"><pre><code>&quot;scripts&quot;:{
    &quot;serve&quot;: &quot;vue-cli-service serve --mode=dev --mobile -config build/example.js&quot;
}
</code></pre></div><p>当我们执行 npm run server 命令的时候，process.argv 的具体内容为：</p> <div class="language- extra-class"><pre><code>[ '/usr/local/Cellar/node/12.14.1/bin/node',
'/Users/mac/Vue-projects/hao-cli/node_modules/.bin/vue-cli-service',
'serve',
'--mode=dev',
'--mobile',
'-config',
'build/example.js']

npm run serve --params  // 参数params将转化成process.env.npm_config_params = true
npm run serve --params=123 // 参数params将转化成process.env.npm_config_params = 123
npm run serve -params  // 等同于--params参数

npm run serve -- --params  // 将--params参数添加到process.env.argv数组中
npm run serve params  // 将params参数添加到process.env.argv数组中
npm run serve -- params  // 将params参数添加到process.env.argv数组中
</code></pre></div><p>对比下 npm install koa2 --save 是不是知道了bin脚本中接收到的 process.env.npm_config_save = true; 我想是这样的，有兴趣的小伙伴去看源码验证下。</p> <ul><li><p>执行顺序</p> <p>并行任务(同时的平行执行)，使用&amp;符号</p> <div class="language- extra-class"><pre><code>npm run script1.js &amp; npm run script2.js
</code></pre></div><p>串行任务(前一个任务成功，才执行下一个任务)，使用 &amp;&amp; 符号</p> <div class="language- extra-class"><pre><code>npm run script1.js &amp;&amp; npm run script2.js
</code></pre></div><p>我们配置的脚本命令，如 &quot;start&quot;: &quot;node test.js&quot;，node test.js 会当做一行代码传递给系统的 shell 去解释执行。实际使用的 shell 可能会根据系统平台而不同，类 UNIX 系统里，如 macOS 或 linux 中指代的是 /bin/sh， 在 windows 中使用的是 cmd.exe。原理我们也看了，因为交给 shell 去解释执行的，说明配置的脚本可以是任意能够在 shell 中运行的命令，而不仅仅是 node 脚本或者 js 代码。如果你的系统里安装了 python（或者说系统变量 PATH里能找到 python 命令），你也可以将 scripts 配置为 &quot;myscript&quot;: &quot;python xxx.py&quot;</p></li></ul></li> <li><p><strong>npm 配置</strong></p> <p>npm config</p> <p>npm cli 提供了 npm config 命令进行 npm 相关配置，通过 npm config ls -l 可查看 npm 的所有配置，包括默认配置。npm 文档页为每个配置项提供了详细的说明 https://docs.npmjs.com/misc/config .修改配置的命令为 npm config set, 我们使用相关的常见重要配置:</p> <p>• proxy, https-proxy: 指定 npm 使用的代理</p> <p>• registry 指定 npm 下载安装包时的源，默认为 https://registry.npmjs.org/ 可以指定为私有 Registry 源</p> <p>• package-lock 指定是否默认生成 package-lock 文件，建议保持默认 true</p> <p>• save true/false 指定是否在 npm install 后保存包为 dependencies, npm 5 起默认为 true</p> <p>删除指定的配置项命令为 npm config delete &lt;key&gt;.</p> <div class="language- extra-class"><pre><code>设置淘宝镜像
npm config set registry https://registry.npm.taobao.org

恢复使用之前的 npm
npm config set registry https://registry.npmjs.org
</code></pre></div><p>如果env环境变量中存在以npm_config_为前缀的环境变量，则会被识别为npm的配置属性。比如在env环境变量中设置npm_config_package_lock变量:</p> <div class="language- extra-class"><pre><code>export npm_config_package_lock=false //修改的是内存中的变量，只对当前终端有效
</code></pre></div><p>这时候执行npm install，npm会从环境变量中读取到这个配置项，从而不会生成package-lock.json文件。</p></li> <li><p><strong>npmrc 文件</strong></p> <p>除了使用 CLI 的 npm config 命令显示更改 npm 配置，还可以通过 npmrc 文件直接修改配置。</p> <p>这样的 npmrc 文件优先级由高到低包括：</p> <p>• 工程内配置文件: /path/to/my/project/.npmrc</p> <p>• 用户级配置文件: ~/.npmrc</p> <p>• 全局配置文件: $PREFIX/etc/npmrc (即npm config get globalconfig 输出的路径)</p> <p>• npm内置配置文件:/path/to/npm/npmrc</p></li></ul> <p>很多时候我们在公司内网需要通过代理才能访问npm源，通过这个机制，我们可以方便地在工程跟目录创建一个 .npmrc 文件来共享需要在团队间共享的 npm 运行相关配置。比如如果我们在公司内网环境下需通过代理才可访问 registry.npmjs.org 源，或需访问内网的 registry, 就可以在工作项目下新增 .npmrc 文件并提交代码库。</p> <div class="language- extra-class"><pre><code>  proxy = http://proxy.example.com/

  https-proxy = http://proxy.example.com/

  registry = http://registry.example.com/
</code></pre></div><ul><li><p><strong>npm 包发布</strong></p> <p>规范的 npm 模块目录
一个 node.js 模块是基于 CommonJS 模块化规范实现的，严格按照 CommonJS 规范，模块目录下除了必须包含包描述文件 package.json 以外，还需要包含以下目录：</p> <p>• bin：存放可执行二进制文件的目录</p> <p>• lib：存放js代码的目录</p> <p>• doc：存放文档的目录</p> <p>• test：存放单元测试用例代码的目录</p> <p>如何发布自己的 npm 包</p> <p>先去 npm 注册个账号，然后在命令行使用</p> <div class="language- extra-class"><pre><code>npm adduser #根据提示输入用户名密码即可
</code></pre></div><p>使用命令发布你的包</p> <p><font color="#8C8C8C" size="3">在推送之前，可以通过配置一个 .npmignore 文件来排除一些文件, 防止大量的垃圾文件推送到 npm, 规则上和你用的 .gitignore 是一样的。.gitignore 文件也可以充当 .npmignore 文件</font></p> <div class="language- extra-class"><pre><code>npm publish
</code></pre></div><p>发布成功之后，你就可以像下载安装其他包一样使用你自己的开发工具了</p> <div class="language- extra-class"><pre><code>npm install koalanpmstudy
</code></pre></div></li> <li><p><strong>关于 npm 包的更新</strong></p> <p>更新 npm 包也是使用 npm publish 命令发布，不过必须更改 npm 包的版本号，即 package.json 的 version 字段，否则会报错，同时我们应该遵 Semver(语义化版本号) 规范，npm 提供了 npm version 给我们升级版本</p> <div class="language- extra-class"><pre><code># 升级补丁版本号
$ npm version patch

# 升级小版本号
$ npm version minor

# 升级大版本号
$ npm version major
</code></pre></div></li> <li><p><strong>本地开发的 npm 包如何调试</strong></p> <p>在本地开发的模块包的时候，可以使用 npm link 调试，将模块链接到对应的运行项目中去，方便地对模块进行调试和测试。具体使用步骤如下
• 假如我的项目是 koalaNpmStudy，假如我的 npm 模块包名称是 npm-ikoala</p> <p>• 进入到 模块包 npm-ikoala 目录中，执行 npm link</p> <p>• 在自己的项目 koalaNpmStudy 中创建连接执行 npm link npm-ikoala</p> <p>• 在自己项目的 node_module 中会看到链接过来的模块包，然后就可以像使用其他的模块包一样使用它了。</p> <p>• 调试结束后可以使用 npm unlink 取消关联</p> <font color="#8C8C8C" size="3">
npm link 主要做了两件事：
1. 为目标 npm 模块创建软链接，将其链接到全局 node 模块安装路径 /usr/local/lib/node_modules/。
2. 为目标 npm 模块的可执行 bin 文件创建软链接，将其链接到全局 node 命令安装路径 /usr/local/bin/。
</font> <p>npx出现  --- 命令行开发方式</p> <p>npm 从5.2版开始，增加了 npx 命令，react-native也在0.61版本文档中推荐使用npx来创建项目。</p> <p>npx的作用：</p> <p>• 运行的时候，会到node_modules/.bin路径和环境变量$PATH里面，检查命令是否存在。</p> <p>• npx 还能避免全局安装的模块，npx 将包下载到一个临时目录，使用以后再删除。比如我们想启动一个web服务，只需在根目录下npx http-server。</p> <p>• 可以指定某个版本的 Node 运行脚本。某些场景下，这个方法用来切换 Node 版本，要比 nvm 那样的版本管理器方便一些。</p> <p>• npx 还可以执行 GitHub 上面的模块源码。</p></li></ul> <h2 id="npm私服搭建"><a href="#npm私服搭建" class="header-anchor">#</a> npm私服搭建</h2> <ul><li><p>verdaccio</p> <p>verdaccio是nodejs 创建的轻量的私有npm proxy registry，froked于sinopia@1.4.0 ,是一个开源的npm私有库的搭建工具，可以搭建一套属于自己公司的npm仓库。</p> <p>与yarn 、npm 和pnmp  100%兼容
提供的Docker和Kubernetes支持，很容易安装和使用
发布的包是私有和配置访问权限
verdaccio是需要缓存所有相关项，并且在本地或者私有网络下可以加速安装</p> <p>npm私有库只针对公司内部局域网开放，不对外部公开，具有一定的保密性</p> <p>速度比在直接在npm下载更快，甚至是比淘宝源更快。因为毕竟是在公司局域网</p> <p>对于发布和下载npm包配置权限管理</p> <p>私有库能够将包资源进行缓存，响应的话会加快下载速度</p> <div class="language- extra-class"><pre><code>//npm下载
npm install -g verdaccio

//yarn下载  用yarn下载的时候 verdaccio运行不起来的时候请换成npm下载
yarn global add verdaccio

//或者nrm切换下源地址  要是报权限错误的话，请选择cmd&lt;以管理员身份运行&gt;在输入一次
//或者在cmd输入下面的命令：
npm install -g verdaccio --unsafe-perm
//--unsafe-perm添加上是为了防止报 gyp ERR! permission denied 的权限问题

//下载完成后会有红色字体表示：表示没有python的环境，这个时候不需要理会。

//在cmd输入：verdaccio 执行

pm2方式管理

npm i -g pm2

pm2 start verdaccio
</code></pre></div><p>访问http://localhost:4873</p> <p>config.yaml文件配置信息：https://verdaccio.org/docs/en/configuration</p> <p>添加私服到nrm管理</p> <div class="language- extra-class"><pre><code>nrm add verdaccio http://localhost:4873

nrm use verdaccio
</code></pre></div><p>构建包发布</p> <div class="language- extra-class"><pre><code>npm addUser

npm login

npm publish
</code></pre></div></li> <li><p>cnpm</p> <p>阿里提供的一个搭建私服环境服务</p> <ol><li><p>克隆</p> <p>git clone https://github.com/cnpm/cnpmjs.org.git</p> <p>//安装项目依赖   cd cnpmjs.org
npm install</p></li> <li><p>修改配置 （config/index.js）</p></li></ol> <p>主要配置运用数据库选择(mysql, sqlite), 私服相关对外访问口，上拉地址等</p> <ol start="3"><li>安装数据库</li></ol> <p>默认为sqlite, 我选择了mysql;</p> <div class="language- extra-class"><pre><code>  登录数据库

  mysql -u root -p 123456

  创建数据库，这里的数据库名字要和config/index.js中统一

  create database cnpm_test

  切换到cnpm_test数据库
  use cnpm_test;

  导入cnpm.org中的docs/db.sql生成数据表;目录在cnpm.org目录下

  source ./docs/db.sql

  查看导入数据表

  show tables;
</code></pre></div><ol start="4"><li><p>启动访问服务</p> <div class="language- extra-class"><pre><code> cd cnpm.org &amp;&amp; node dispatch.js

 访问http://127.0.0.1:7002 为私服服务查询站点

 访问http://127.0.0.1:7001 为私服地址，私服上传地址
</code></pre></div></li></ol> <p>完成搭建展示</p> <p><img src="/blog/images/pub-success.jpg" alt="An image"></p> <p><img src="/blog/images/cnpm1.jpg" alt="An image"></p> <p><img src="/blog/images/cnpm2.jpg" alt="An image"></p> <p><img src="/blog/images/cnpm3.jpg" alt="An image"></p> <p><img src="/blog/images/data1.jpg" alt="An image"></p> <p><img src="/blog/images/data2.jpg" alt="An image"></p></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/project/ui-component.html" class="prev">
        组件开发
      </a></span> <span class="next"><a href="/blog/project/wokoo.html">
        wokoo浏览器插架
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.a3423334.js" defer></script><script src="/blog/assets/js/2.a973bc12.js" defer></script><script src="/blog/assets/js/22.2aefa173.js" defer></script>
  </body>
</html>
