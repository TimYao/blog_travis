<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>简介 | 知识文章</title>
    <meta name="generator" content="VuePress 1.4.1">
    
    <meta name="description" content="This is a blog.">
    <link rel="preload" href="/blog/assets/css/0.styles.eea3ff88.css" as="style"><link rel="preload" href="/blog/assets/js/app.a3423334.js" as="script"><link rel="preload" href="/blog/assets/js/2.a973bc12.js" as="script"><link rel="preload" href="/blog/assets/js/17.902c3621.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.874ad3ec.js"><link rel="prefetch" href="/blog/assets/js/11.0711065f.js"><link rel="prefetch" href="/blog/assets/js/12.c40d93da.js"><link rel="prefetch" href="/blog/assets/js/13.da43d7f3.js"><link rel="prefetch" href="/blog/assets/js/14.5f50c20e.js"><link rel="prefetch" href="/blog/assets/js/15.d82d9cf0.js"><link rel="prefetch" href="/blog/assets/js/16.ff02c56f.js"><link rel="prefetch" href="/blog/assets/js/18.690ad6d6.js"><link rel="prefetch" href="/blog/assets/js/19.e8feab27.js"><link rel="prefetch" href="/blog/assets/js/20.1d7fcf1c.js"><link rel="prefetch" href="/blog/assets/js/21.16c4ed2a.js"><link rel="prefetch" href="/blog/assets/js/22.2aefa173.js"><link rel="prefetch" href="/blog/assets/js/23.4e5640f3.js"><link rel="prefetch" href="/blog/assets/js/24.ba1b495a.js"><link rel="prefetch" href="/blog/assets/js/25.e8666563.js"><link rel="prefetch" href="/blog/assets/js/26.5787142e.js"><link rel="prefetch" href="/blog/assets/js/27.b2722766.js"><link rel="prefetch" href="/blog/assets/js/28.5aa26eb0.js"><link rel="prefetch" href="/blog/assets/js/29.3d2624e8.js"><link rel="prefetch" href="/blog/assets/js/3.f86f4f75.js"><link rel="prefetch" href="/blog/assets/js/30.29661336.js"><link rel="prefetch" href="/blog/assets/js/31.447afcaa.js"><link rel="prefetch" href="/blog/assets/js/32.c2bd8e9a.js"><link rel="prefetch" href="/blog/assets/js/33.797423e5.js"><link rel="prefetch" href="/blog/assets/js/34.ee1d27eb.js"><link rel="prefetch" href="/blog/assets/js/35.89ff95b9.js"><link rel="prefetch" href="/blog/assets/js/36.a6567a31.js"><link rel="prefetch" href="/blog/assets/js/37.e0cd8c86.js"><link rel="prefetch" href="/blog/assets/js/38.4ca67963.js"><link rel="prefetch" href="/blog/assets/js/39.4bec9a8a.js"><link rel="prefetch" href="/blog/assets/js/4.221a248a.js"><link rel="prefetch" href="/blog/assets/js/40.6b72df98.js"><link rel="prefetch" href="/blog/assets/js/41.91a0c3cd.js"><link rel="prefetch" href="/blog/assets/js/42.c495687d.js"><link rel="prefetch" href="/blog/assets/js/43.fc90ceb9.js"><link rel="prefetch" href="/blog/assets/js/44.5da0fdd6.js"><link rel="prefetch" href="/blog/assets/js/5.d9260729.js"><link rel="prefetch" href="/blog/assets/js/6.e532ac18.js"><link rel="prefetch" href="/blog/assets/js/7.d43e6edf.js"><link rel="prefetch" href="/blog/assets/js/8.0d7bba76.js"><link rel="prefetch" href="/blog/assets/js/9.d2e1456d.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.eea3ff88.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">知识文章</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/TimYao" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/TimYao" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/blog/jsdoc.html" class="sidebar-link">JS</a></li><li><a href="/blog/all.html" class="sidebar-link">Html/Css</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>前端框架</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/frame/vue.html" class="sidebar-link">vue</a></li><li><a href="/blog/frame/vue-demi.html" class="sidebar-link">vue-demi</a></li><li><a href="/blog/frame/vue3.html" class="sidebar-link">vue3</a></li><li><a href="/blog/frame/vuex.html" class="active sidebar-link">vuex</a></li><li><a href="/blog/frame/vue-router.html" class="sidebar-link">vue-router</a></li><li><a href="/blog/frame/vuessr.html" class="sidebar-link">vuessr</a></li><li><a href="/blog/frame/react.html" class="sidebar-link">react</a></li></ul></section></li><li><a href="/blog/test.html" class="sidebar-link">测试</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>构建工具</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>服务端</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/blog/replease.html" class="sidebar-link">发布上线</a></li><li><a href="/blog/expand.html" class="sidebar-link">扩展知识</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>源码分析</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/blog/resource.html" class="sidebar-link">资料</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>项目实践</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/blog/sf.html" class="sidebar-link">算法学习</a></li><li><a href="/blog/408.html" class="sidebar-link">计算机408课本</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h2> <p>vuex是基于Vue所提供的独立的状态管理库；通过全局单例模式实现了对数据状态统一管理，对外提供变更状态的方法(commit, dispatch);主要解决了多视图依赖同一个状态，多组件之间的传递频繁，复杂，不好管理；多个视图需要各自调用行为发起状态的变更操作，行为方法不统一；通过全局独立对象管理，既可以对状态统一管理，又可以提供了统一的发起状态修改行为方法，使功能更加内聚，低耦合，管理会更好</p> <ul><li><p>vuex利用vue的响应式数据方式</p></li> <li><p>利用了vue中对于更新视图粒度的方式</p></li> <li><p>依赖于Vue</p></li></ul> <h2 id="实现流程"><a href="#实现流程" class="header-anchor">#</a> 实现流程</h2> <ul><li><p>实现Vue.use支持安装插件方式</p> <p>建立导出对象中包括install方法，将Vue传入install中，通过Vue.mixin方式混入beforeCreate钩子函数，完成在Vue.options; 将options.store对象定义到每一个子组件实例对象的实例属性$store上</p></li> <li><p>创建Vue.Store类方法；实现原型上需要的方法commit, dispatch，replaceState,registerModule等方法</p></li> <li><p>利用数组栈的原理，处理数据格式化，建立各数据模块之间的父子关系</p></li> <li><p>通过建立各path之间拼接完成的路径来建立各模块数据的作用域映射关系</p></li> <li><p>通过实例化Vue实例，将state绑定到data上，将getters上的方法通过Object.defineProperty方式转为getter,setter方式，并绑入vue实例的computed上，实现缓存</p></li> <li><p>提供类的属性访问器state方法，对用户暴露读取state的属性访问方式， 并利用Vue.set方式动态向父对象添加状态</p></li> <li><p>利用vm.$watch方式监测和AOP思想来监测是否直接修改state状态属性值，提供错误提醒</p></li> <li><p>插架实现</p></li></ul> <h2 id="设计思想"><a href="#设计思想" class="header-anchor">#</a> 设计思想</h2> <ol><li>发布订阅思想</li></ol> <p>mutations,actions中定义属性和方法映射关系加入到_mutations,_actions中存储，对外提供commit, dispatch方法，通过type类型在_mutations,_actions中映射到对应方法调用执行，并传入payload修改的值，这里要注意的是，mutation主要是完成修改state操作，action主要是对mutation的一层封装，完成一些异步操作</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token comment">// 简例</span>
  <span class="token keyword">let</span> _mutations <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> <span class="token function-variable function">addMutation</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    _mutations<span class="token punctuation">[</span>type<span class="token punctuation">]</span> <span class="token operator">=</span>  _mutations<span class="token punctuation">[</span>type<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    _mutations<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">payload</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">fn</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">let</span> <span class="token function-variable function">commit</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> payload</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> mutation <span class="token operator">=</span> _mutations<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">;</span>
    mutation <span class="token operator">&amp;&amp;</span> <span class="token function">mutation</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'start'</span><span class="token punctuation">,</span> <span class="token string">'hello'</span><span class="token punctuation">)</span>
</code></pre></div><ol start="2"><li>包装器切片编程（AOP）</li></ol> <p>在处理防止在严格模式下对state状态的改变，通过vm.$watch监测state,默认开关状态为this._committing = false,更改触发watch监测报错，mutations,actions下触发,通过调用此层包装函数开启执行；切片编程的好处可以劫持提供函数功能，增加业务，但不影响老业务</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">this</span><span class="token punctuation">.</span>_committing <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token function">_willing</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> _committing <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_committing<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_committing <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_committing <span class="token operator">=</span> _committing<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre></div><ol start="3"><li>单例模式</li></ol> <p>在Vue.use模式下安装插件，内部传入Vue，锁定版本，并做排除多次安装插件问题;全局状态下只有一个Vuex实例</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token comment">// 简例</span>
  <span class="token comment">// 插件实现定义方式</span>
  <span class="token keyword">let</span> Vue
  <span class="token keyword">let</span> <span class="token function-variable function">install</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">_Vue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Vue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 锁定传入Vue版本</span>
    Vue <span class="token operator">=</span> _Vue<span class="token punctuation">;</span>
    <span class="token comment">// ....... 插件只安装一次</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 主vuex类定义</span>
  <span class="token keyword">class</span> <span class="token class-name">Store</span> <span class="token punctuation">{</span>
    <span class="token function">construct</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token comment">// 初始化各配置</span>
    <span class="token punctuation">}</span>
    <span class="token function">commit</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> payload</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> payload</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 对外暴露模块</span>
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    Store<span class="token punctuation">,</span>
    install
  <span class="token punctuation">}</span>

  <span class="token comment">// 应用入口导入使用</span>
  <span class="token keyword">import</span> Vuex <span class="token keyword">from</span> <span class="token string">'vuex'</span>
  <span class="token keyword">let</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    state<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    mutations<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    actions<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    modules<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    store
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><ol start="4"><li>利用栈数据结构存储，建立父子模块关系</li></ol> <p>利用先进栈的模块会后进栈模块的父模块，利用reduce方法进行迭代</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token comment">// 基本模型</span>
  <span class="token keyword">let</span> modules <span class="token operator">=</span> <span class="token punctuation">{</span>
    state<span class="token operator">:</span> <span class="token punctuation">{</span>
      a<span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    mutations<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">m1</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    modules<span class="token operator">:</span> <span class="token punctuation">{</span>
      subA<span class="token operator">:</span> <span class="token punctuation">{</span>
        state<span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token string">'suba'</span><span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">let</span> root<span class="token punctuation">;</span>
  <span class="token keyword">let</span> <span class="token function-variable function">register</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">path<span class="token punctuation">,</span> modules</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> rawModule <span class="token operator">=</span> <span class="token punctuation">{</span>
      _rawModule<span class="token operator">:</span> modules<span class="token punctuation">,</span>
      state<span class="token operator">:</span> modules<span class="token punctuation">.</span>state<span class="token punctuation">,</span>
      children<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>root<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      root <span class="token operator">=</span>  rawModule<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> parent <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">rawModule<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> rawModule<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> root<span class="token punctuation">)</span><span class="token punctuation">;</span>
      parent<span class="token punctuation">[</span><span class="token string">'children'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>path<span class="token punctuation">[</span>path<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> rawModule<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 循环子模块</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>rawModule<span class="token punctuation">.</span>_rawModule<span class="token punctuation">.</span>modules<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>rawModule<span class="token punctuation">.</span>_rawModule<span class="token punctuation">.</span>modules<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> rawChildrenModule <span class="token operator">=</span> rawModule<span class="token punctuation">.</span>_rawModule<span class="token punctuation">.</span>modules<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token function">register</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> rawChildrenModule<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> modules<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 结果模板</span>
  <span class="token comment">/*
     root = {
       _rawModule: rawModule
       state: {},
       children: {
         subModule1,
         subModule2
       }
     }
  */</span>
</code></pre></div><h2 id="vuex-总结"><a href="#vuex-总结" class="header-anchor">#</a> Vuex 总结</h2> <ul><li><p>state 数据状态，即vue中的data数据；通过将state定义在实例的vue上，主要是完成数据的双向绑定</p></li> <li><p>getters 数据的计算属性，目的是为了可以关联到state，但可以在依赖的数据发送变化时更新；通过定义在vue实例的computed上来实现，实现了懒计算</p></li> <li><p>mutations 唯一可以触发state状态去改变，主要收集起来函数行为，订阅起来，后期发布;此方法只能执行同步逻辑</p></li> <li><p>actions 为解决异步方法执行而提供了，但在更改state变化还是需要通过触发mutation里方法来完成；内部支持异步原因是，在dispatch发布时，会以promise.all方式来等所有的订阅方法执行完成，返回是一个promise</p></li> <li><p>commit/dispatch 完成对mutations和actions来完成发布订阅的方法</p></li> <li><p>modules 模块方法主要是完成划分空间，通过namespaced标识为true来完成；在订阅mutations,actions时会遍历到当前模块是否具有该属性，如果有当前方法名会填入当前模块的key来完成，例如：modules:{namespaced: true,a:{mutations:{age(){}}}}; -&gt; a/age: fn</p></li> <li><p>plugins 完成自定义一些功能，注入到vuex中，基本思想也是通过发布订阅来完成，插件即一个函数，内部会订阅函数，并执行传入实例store;用户内部会调用store.subscribe完成订阅；并在mutation的commit触发后执行</p></li> <li><p>strict 严格模式，主要是防止直接修改state属性而开启，通过vue.$watch监测store._vm._data.$$state属性，vue对于$开头的属性不会代理到实例上。</p></li> <li><p>registerModule 注册新模块，重新调用register方法，installModule, restoreVm</p></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/frame/vue3.html" class="prev">
        vue3
      </a></span> <span class="next"><a href="/blog/frame/vue-router.html">
        vue-router
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.a3423334.js" defer></script><script src="/blog/assets/js/2.a973bc12.js" defer></script><script src="/blog/assets/js/17.902c3621.js" defer></script>
  </body>
</html>
