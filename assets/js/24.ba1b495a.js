(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{354:function(t,s,a){"use strict";a.r(s);var e=a(33),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"wokoo浏览器插架开发"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#wokoo浏览器插架开发"}},[t._v("#")]),t._v(" wokoo浏览器插架开发")]),t._v(" "),a("p",[t._v("集成了开发环境搭建，不需要个人手动搭建开发环境，提供vue, react方式框架开发，浏览器自身提供了wokoo环境嵌入方式，方便了开发流程")]),t._v(" "),a("p",[t._v("wokoo项目地址："),a("a",{attrs:{href:"https://gitee.com/TimLie/wokoo"}},[t._v("https://gitee.com/TimLie/wokoo")])]),t._v(" "),a("p",[t._v("wokoo脚手架分析： "),a("a",{attrs:{href:"https://gitee.com/TimLie/browser-plugin"}},[t._v("https://gitee.com/TimLie/browser-plugin")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("理解wokoo 脚手架")]),t._v(" "),a("p",[t._v("利用了lerna多包管理, 独立的各个包功能 wokoo-scripts与wokoo-template")]),t._v(" "),a("ul",[a("li",[a("p",[a("strong",[t._v("wokoo-scripts")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("commander模块完成对命令参数解析")]),t._v(" "),a("p",[t._v("主要做创建项目目录，对项目创建package.json文件")])]),t._v(" "),a("li",[a("p",[t._v("在项目目录下安装wokoo-template模块，提供开发模板选择")]),t._v(" "),a("p",[t._v("主要利用开启单独进程来完成npm install 命令安装模块")])]),t._v(" "),a("li",[a("p",[t._v("提供交互是命令选择开发框架")]),t._v(" "),a("p",[t._v("主要利用inquirer模块开启交互式问答方式选择开发模板")])]),t._v(" "),a("li",[a("p",[t._v("完成选择模板开发的配置，模板编译，导入到开发项目根目录下")]),t._v(" "),a("p",[t._v("主要导入wokoo-template下webpack.config.js,public,.gitignore,以及对选择模板目录下进行遍历编译ejs模板（传入参数），并将模板导入开发项目根目录下临时目录，最终导入根目录删除临时目录，合并开发项目package.json配置与单独模板template.json进行合并，建立独立进程安装依赖模块，卸载wokoo-template模块")])])])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("wokoo-template")])]),t._v(" "),a("p",[t._v("提供了vue-template与react-template模板相关（挂载模板内容，template.json, webpack配置信息）")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/kinyaying/wokoo/tree/master/packages/wokoo-template"}},[t._v("查看wokoo-template")])])])])]),t._v(" "),a("li",[a("p",[t._v("运用 wokoo 开发")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("安装wokoo")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("  npm i wokoo "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("g\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 创建开发目录")]),t._v("\n  wokoo projectName\n")])])])]),t._v(" "),a("li",[a("p",[t._v("选择开发模板(vue/react)")])]),t._v(" "),a("li",[a("p",[t._v("启动开发")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("  npm start\n")])])])]),t._v(" "),a("li",[a("p",[t._v("浏览器安装支持插件")]),t._v(" "),a("p",[t._v("chrome 插件")]),t._v(" "),a("p",[a("img",{attrs:{src:"/blog/images/plugin.jpg",alt:"An image"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"/blog/images/temonkey.jpg",alt:"An image"}})])]),t._v(" "),a("li",[a("p",[t._v("项目打包")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("  npm run build\n")])])])]),t._v(" "),a("li",[a("p",[t._v("项目嵌入Tampermonkey插件")]),t._v(" "),a("p",[t._v("将项目下tampermonkey.js内容添加导入到")]),t._v(" "),a("p",[a("img",{attrs:{src:"/blog/images/temonkey.jpg",alt:"An image"}})]),t._v(" "),a("p",[t._v("tampermonkey.js 内容，提供匹配规则，可查看文档，思路为将运行脚本动态插入到浏览器中")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ==UserScript==")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// @name         MoveSearch")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// @namespace    http://tampermonkey.net/")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// @version      0.0.1")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// @description  try to take over the world!")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// @author")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// @match        https://*/*")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// @match        http://*/*")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ==/UserScript==")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'use strict'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("location"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("href "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://localhost:8080/'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" script "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'script'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 若项目打包，则这里的脚本可以换为打包好的脚本，脚本方式：放入cdn导入cdn地址；直接粘贴打包代码，去除第三方脚本，以配置方式导入，防止嵌入代码过大无法正常导入")]),t._v("\n    script"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://localhost:8080/app.bundle.js'")]),t._v("\n    document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendChild")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("运用中的问题")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("csp内容安全策略导致，无法将脚本导入浏览器页面中，通过安装关闭csp浏览器插件关闭，或者利用charless等代理工具配置rewrite规则")])]),t._v(" "),a("li",[a("p",[t._v("功能api接口出现跨域问题，提供外网服务，并配置请求头信息Access-Control-Allow-Origin 等头信息")])])])])])])])])}),[],!1,null,null,null);s.default=n.exports}}]);