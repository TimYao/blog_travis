<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>js组成 | 知识文章</title>
    <meta name="generator" content="VuePress 1.4.1">
    
    <meta name="description" content="This is a blog.">
    <link rel="preload" href="/blog/assets/css/0.styles.eea3ff88.css" as="style"><link rel="preload" href="/blog/assets/js/app.a3423334.js" as="script"><link rel="preload" href="/blog/assets/js/2.a973bc12.js" as="script"><link rel="preload" href="/blog/assets/js/18.690ad6d6.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.874ad3ec.js"><link rel="prefetch" href="/blog/assets/js/11.0711065f.js"><link rel="prefetch" href="/blog/assets/js/12.c40d93da.js"><link rel="prefetch" href="/blog/assets/js/13.da43d7f3.js"><link rel="prefetch" href="/blog/assets/js/14.5f50c20e.js"><link rel="prefetch" href="/blog/assets/js/15.d82d9cf0.js"><link rel="prefetch" href="/blog/assets/js/16.ff02c56f.js"><link rel="prefetch" href="/blog/assets/js/17.902c3621.js"><link rel="prefetch" href="/blog/assets/js/19.e8feab27.js"><link rel="prefetch" href="/blog/assets/js/20.1d7fcf1c.js"><link rel="prefetch" href="/blog/assets/js/21.16c4ed2a.js"><link rel="prefetch" href="/blog/assets/js/22.2aefa173.js"><link rel="prefetch" href="/blog/assets/js/23.4e5640f3.js"><link rel="prefetch" href="/blog/assets/js/24.ba1b495a.js"><link rel="prefetch" href="/blog/assets/js/25.e8666563.js"><link rel="prefetch" href="/blog/assets/js/26.5787142e.js"><link rel="prefetch" href="/blog/assets/js/27.b2722766.js"><link rel="prefetch" href="/blog/assets/js/28.5aa26eb0.js"><link rel="prefetch" href="/blog/assets/js/29.3d2624e8.js"><link rel="prefetch" href="/blog/assets/js/3.f86f4f75.js"><link rel="prefetch" href="/blog/assets/js/30.29661336.js"><link rel="prefetch" href="/blog/assets/js/31.447afcaa.js"><link rel="prefetch" href="/blog/assets/js/32.c2bd8e9a.js"><link rel="prefetch" href="/blog/assets/js/33.797423e5.js"><link rel="prefetch" href="/blog/assets/js/34.ee1d27eb.js"><link rel="prefetch" href="/blog/assets/js/35.89ff95b9.js"><link rel="prefetch" href="/blog/assets/js/36.a6567a31.js"><link rel="prefetch" href="/blog/assets/js/37.e0cd8c86.js"><link rel="prefetch" href="/blog/assets/js/38.4ca67963.js"><link rel="prefetch" href="/blog/assets/js/39.4bec9a8a.js"><link rel="prefetch" href="/blog/assets/js/4.221a248a.js"><link rel="prefetch" href="/blog/assets/js/40.6b72df98.js"><link rel="prefetch" href="/blog/assets/js/41.91a0c3cd.js"><link rel="prefetch" href="/blog/assets/js/42.c495687d.js"><link rel="prefetch" href="/blog/assets/js/43.fc90ceb9.js"><link rel="prefetch" href="/blog/assets/js/44.5da0fdd6.js"><link rel="prefetch" href="/blog/assets/js/5.d9260729.js"><link rel="prefetch" href="/blog/assets/js/6.e532ac18.js"><link rel="prefetch" href="/blog/assets/js/7.d43e6edf.js"><link rel="prefetch" href="/blog/assets/js/8.0d7bba76.js"><link rel="prefetch" href="/blog/assets/js/9.d2e1456d.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.eea3ff88.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">知识文章</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/TimYao" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/TimYao" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/blog/jsdoc.html" class="sidebar-link">JS</a></li><li><a href="/blog/all.html" class="sidebar-link">Html/Css</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端框架</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/blog/test.html" class="sidebar-link">测试</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>构建工具</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>服务端</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/blog/replease.html" class="sidebar-link">发布上线</a></li><li><a href="/blog/expand.html" class="sidebar-link">扩展知识</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>源码分析</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/blog/resource.html" class="sidebar-link">资料</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>项目实践</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/blog/sf.html" class="sidebar-link">算法学习</a></li><li><a href="/blog/408.html" class="sidebar-link">计算机408课本</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="js组成"><a href="#js组成" class="header-anchor">#</a> js组成</h2> <ul><li><p>组成于es5/es6 + dom + bom</p> <p>es5/es6基本语法提供</p> <p>dom提供脚本方式操作文档</p> <p>bom依赖运行环境为window提供的API方法</p></li></ul> <h2 id="js理解"><a href="#js理解" class="header-anchor">#</a> js理解</h2> <ul><li><p>文法： 编译原理主要强调用什么样的语法来表示，透过基本的语法，编译思想，比如将语法分析为对应的规则，AST来完成对语句的理解（分为词法，语法）</p> <ul><li><p>词法：通过将字符串转换为token理解的独立单元，通过token独立单元映射到对应的方法生成AST树，通过AST树完成对原始语法的转换</p></li> <li><p>语法：预处理分析代码中的变量如何分析，如何界定范围，如何处理代码解析，时序指令定义了如何按指定的模式分析代码</p></li></ul></li> <li><p>语义：通过文法来表达语义</p></li> <li><p>运行（执行）</p> <ul><li><p>数据结构</p> <blockquote><p>七种类型：原始类型（number string boolean symbol）+ (null undefined object)</p></blockquote> <blockquote><p>类型转换（原始类型间转换，原始类型与引用类型转换）</p></blockquote> <div class="language- extra-class"><pre><code>原始类型：  number(有限数字，无限数字Infinity，NaN)
          parseInt,parseFloat,Number
          string(空字符，非空字符)
          toString,String
          boolean(true, false)
          symbol(标识描述)

转换：运算+运算模式，操作数存在字符，拼接行为
     其他运算模式，操作数转为数字行为进行操作
     特殊模式null,undefined,NaN,Infinity

     比如： '' + 1 =&gt; '1'
           1 + true
           null + 1 =&gt; 1
           null + 0 =&gt; 0
           null + null =&gt; 0
           null + undefined =&gt; NaN
           null + Infinity =&gt; Infinity
           null + NaN =&gt; NaN
           undefined + undefined/NaN/Infinity =&gt; NaN
           Infinity + Infinity =&gt; Infinity
           Infinity*Infinity =&gt; Infinity
           Infinity / Infinity =&gt; NaN
           Infinity - Infinity =&gt; NaN
           Infinity/0 =&gt; Infinity

引用类型：object, Array

转换: 将引用类型转为基本类型，之后再转为对应的原始类型
     toPrimitive,valueOf,toString
     toPrimitive可以控制操作优先权
     toPrimitive()，本身提供了三种模式，数字，字符串，default,若是数字模式与default模式将优先valueOf,若是字符模式为toString优先，例如：alert(str) // string mode ； +type // 数字模式
     valueOf或者toString只要转换失败则继续调用
     Symbol.toStringTag可以设置对象类型[object, type]


    [Symbol.toPrimitive](hint) {
      alert(`hint: ${hint}`);
      return hint == &quot;string&quot; ? `{name: &quot;${this.name}&quot;}` : this.money;
    }
</code></pre></div><blockquote><p>类型判断</p></blockquote> <div class="language- extra-class"><pre><code>typeof 除null以外的基本类型
instanceOf 验证构造函数是否再对象原型链上
Object.prototype.toString验证对象所属的类型
constructor 验证对象指向的构造函数
</code></pre></div></li> <li><p>实例</p> <blockquote><p>宿主对象，内置对象js内部提供的（固有对象不需要实例Math，原生对象需要实例对象Date, 普通对象Object, class）</p></blockquote></li> <li><p>算法</p> <blockquote><p>事件循环： 通过开启一个线程来监控和调度js主线程与异步线程完成任务的运行，将完成任务推入等待，通过事件循环来不停访问推入主线程运行</p></blockquote> <blockquote><p>微任务：即浏览器主动发起宏任务，js发起的任务为微任务，宏任务分为同异步，微任务为异步任务，由于JS引擎为单线程，主线程执行处理逻辑，每一个宏任务中优先执行同步任务,之后执行所包含的微任务，以及异步宏任务,之后进行下一个宏任务,当主线程运行完成后，通过事件循环开启下一个任务，直到所有任务队列完成</p></blockquote> <blockquote><p>函数执行：通过函数调用开启执行，形成执行调用栈，函数类型（表达式声明，函数声明，构造函数，箭头函数，async函数，generator函数）</p></blockquote> <blockquote><p>语句执行(普通语句，声明语句)</p></blockquote> <div class="language- extra-class"><pre><code>普通语句:{if,if else,if else if,for,while,do while,for in,for of,switch,break,continue,label,try catch,表达式语句}

声明语句:{let,const,var,class,function}
</code></pre></div></li></ul></li> <li><p>运用</p> <ul><li><p>js引擎</p> <p>以谷歌V8引擎，火狐spider monkey,ie为trident,对如何解析编译理解js，加快对js的处理</p></li> <li><p>宿主对象(dom,bom)，内置对象js, css脚本操作依赖</p></li> <li><p>异步操作和请求</p> <p>回调函数 通过分散复杂功能编程，以回调来通知执行</p> <p>事件发布订阅 通过事件方式来发布订阅</p> <p>发布订阅 通过提前订阅，后期通过触发来发布，内部原理为数组的队列模式存储</p> <p>promise/async...await promise主要还是运用了回调函与异步API，async...await为promise与generator的语法糖</p> <p>generator 可以实现用户暂停和恢复，起到主动控制执行权</p></li> <li><p>js编程思想</p> <ol><li><p>面向过程：面向过程成为具体化，关注编程的执行，一步一步的完成功能化操作，对流程性编程</p></li> <li><p>面向对象：抽象化，非过程中的每一步，功能化一类，将客观事物抽象为一类，对外提供相关操作属性方法，
非细节化</p></li> <li><p>设计模式：</p></li></ol> <p>类与类之间关系(延伸，依赖，聚合两个类之间可分可合，组合类之间不能分离，分离不能更好运用)</p> <p>面向对象（抽象，封装，继承，多态）</p> <div class="language- extra-class"><pre><code>抽象：将客观事物以抽象方式表述，并提供属性和方法对其操作，
     不关心具体细节，只关注所暴露的行为操作

封装：只暴露应该暴露的方法对外，私有方式不暴露对外，提高安全性，易用性

继承：方法属性的公用性，方便类扩展，提高父类，子类的通用性

多态：完成方法属性的多种行为改写，为不同的类提供不同的行为
</code></pre></div><p>思想规则：</p> <div class="language- extra-class"><pre><code>单一规则（函数的功能具体化，一个函数只完成一个相关功能），

开闭原则（关闭修改，开放扩展），实现低耦合，易扩展，

里世替换 依赖抽象而不是具体事例，子类要跟随父行为准则，不能改变

依赖倒置 依赖抽象而不是具体事例

接口封闭 类对接口之间的依赖
</code></pre></div><p>js中面向对象实现：</p> <div class="language- extra-class"><pre><code>原型继承（作为统一类的公共方法，可节省内存，但链过深，加剧查找销毁），

实例继承 （作为具体对象的自身方法，浪费内存，每一次创建都会产生一个，查找速度快）

原型 + 实例继承 公共方法用原型继承，实例方法用实例继承

原型继承方式主要函数都具有prototype指向其原型上的方法，
由于每一个原型都为对象具有__proto__指向所对应的构造函数上的原型，
以prototype,__proto__实现链的方式连接，逐个查找
</code></pre></div><p>设计模式运用：</p> <p>简单工厂模式：通过一个函数包装，返回一个对象实例，通过封装更好的解耦了业务逻辑</p> <div class="language-js extra-class"><pre class="language-js"><code>  例一：
    <span class="token keyword">let</span> <span class="token function-variable function">Factory</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">function</span> <span class="token function">Factory</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> options<span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> options<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Factory</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> factory <span class="token operator">=</span> <span class="token function">Factory</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'生成鞋子'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


  例二：
    <span class="token keyword">interface</span> <span class="token class-name">JQuery</span> <span class="token punctuation">{</span>
      <span class="token punctuation">[</span>index<span class="token operator">:</span>number<span class="token punctuation">]</span><span class="token operator">:</span> any
    <span class="token punctuation">}</span>
    <span class="token keyword">class</span> <span class="token class-name">JQuery</span> <span class="token punctuation">{</span>
      length<span class="token operator">:</span> Number<span class="token punctuation">;</span>
      <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">selector</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> elem <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> length <span class="token operator">=</span> elem <span class="token operator">?</span> elem<span class="token punctuation">.</span>length <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> elem<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token function">html</span><span class="token punctuation">(</span><span class="token parameter">htmlText<span class="token operator">:</span> string <span class="token operator">|</span> <span class="token keyword">undefined</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>htmlText<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> htmlText<span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>innerHTML<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">interface</span> <span class="token class-name">Window</span> <span class="token punctuation">{</span>
      $<span class="token operator">:</span> any
    <span class="token punctuation">}</span>
    window<span class="token punctuation">.</span><span class="token function-variable function">$</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">selector<span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">JQuery</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    jquery库实例化案列
</code></pre></div><p>工厂模式：简单工厂的复杂化，以每个类都具有一个工厂函数完成实例操作，实现多个之间分离不耦合</p> <div class="language-js extra-class"><pre class="language-js"><code>  例一：
    abstract <span class="token keyword">class</span> <span class="token class-name">Coffee</span> <span class="token punctuation">{</span>
      <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> name<span class="token operator">:</span> string</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">class</span> <span class="token class-name">AmericanoCoffee</span> <span class="token keyword">extends</span> <span class="token class-name">Coffee</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">class</span> <span class="token class-name">LatteCoffee</span> <span class="token keyword">extends</span> <span class="token class-name">Coffee</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">class</span> <span class="token class-name">CappuccinoCoffee</span> <span class="token keyword">extends</span> <span class="token class-name">Coffee</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    abstract <span class="token keyword">class</span> <span class="token class-name">CateFactory</span> <span class="token punctuation">{</span>
      abstract <span class="token function">createCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Coffee<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">class</span> <span class="token class-name">AmericanoFactory</span> <span class="token keyword">extends</span> <span class="token class-name">CateFactory</span> <span class="token punctuation">{</span>
      <span class="token function">createCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">AmericanoCoffee</span><span class="token punctuation">(</span><span class="token string">'美式'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">class</span> <span class="token class-name">LatteFactory</span> <span class="token keyword">extends</span> <span class="token class-name">CateFactory</span> <span class="token punctuation">{</span>
      <span class="token function">createCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">LatteCoffee</span><span class="token punctuation">(</span><span class="token string">'拿铁'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">class</span> <span class="token class-name">CappuccinoFactory</span> <span class="token keyword">extends</span> <span class="token class-name">CateFactory</span> <span class="token punctuation">{</span>
      <span class="token function">createCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CappuccinoCoffee</span><span class="token punctuation">(</span><span class="token string">'卡布奇诺'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">let</span> amer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AmericanoFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  例二：
    <span class="token comment">// 创建了工厂函数</span>
    <span class="token keyword">function</span> <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>type<span class="token punctuation">,</span> props<span class="token operator">:</span> config<span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token function">createFactory</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> factory <span class="token operator">=</span> <span class="token function">createElement</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> factory<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> factory <span class="token operator">=</span> <span class="token function">createFactory</span><span class="token punctuation">(</span><span class="token string">'h1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> el <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span><span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token string">'h1'</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">'h1'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>抽象工厂模式 将一类产品与同一相关产品抽象化，同一产品还是通过所对应的工厂函数来完成创建，</p> <p>// factory[createAm, createNt, createKq]抽象类 -&gt; starBuk/luckBuk工厂函数类
// coffee 抽象类 -&gt; Am类，Nt类，Kq类
// Am类，Nt类，Kq类继承coffee抽象类
// starBuk/luckBuk 继承factory并实现具体的createAm, createNt, createKq方法，
方法中返回Am类，Nt类，Kq类实例
// 工厂中的公共行为都是createAm, createNt, createKq行为</p> <p>单例模式：针对实例的唯一性，不重复创建，减少对内存的消耗</p> <div class="language-js extra-class"><pre class="language-js"><code>  例一：
    <span class="token keyword">let</span> Simple <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">Simple</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">let</span> simple<span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">Simple</span> <span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">Simple</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> simple <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Simple</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>simple<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> simple<span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> options<span class="token punctuation">)</span><span class="token punctuation">{</span>
              <span class="token keyword">this</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> options<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            simple <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Simple</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'单例模式'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> p2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Simple</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    弹窗模块案列


  例二：
    <span class="token keyword">class</span> <span class="token class-name">Simple</span> <span class="token punctuation">{</span>
      <span class="token keyword">private</span> <span class="token keyword">static</span> instance<span class="token operator">:</span> Simple<span class="token punctuation">;</span>
      <span class="token keyword">public</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Simple<span class="token punctuation">.</span>instance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          Simple<span class="token punctuation">.</span>instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Simple</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> Simple<span class="token punctuation">.</span>instance<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> w1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Simple</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> w2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Simple</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>w1<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> w2<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 透明单例，不需要告诉用户需要调用什么方法来完成</span>
    <span class="token keyword">let</span> SimpleClassTm <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> instance<span class="token punctuation">;</span>
      <span class="token keyword">let</span> <span class="token function-variable function">SimpleClassTm</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>instance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          instance <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> instance<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> SimpleClassTm<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> w4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token punctuation">(</span><span class="token function">SimpleClassTm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  例三：
    <span class="token comment">// 单例与构建过程的分离（创建单例与类分离的，没有关系）</span>
    <span class="token comment">// 封装单例实现多态话 通过将构造函数以参数的模式传入</span>
    <span class="token keyword">class</span> <span class="token class-name">SimpleClass</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> createSimpleClass <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> instance<span class="token operator">:</span> SimpleClass<span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">Constructor<span class="token operator">?</span><span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>instance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 下面的SimpleClass 以参数传入</span>
          <span class="token comment">// Constructor</span>
          <span class="token comment">/*
            instance = Constructor.apply(this, arguments);
            // instance = this;
            Object.setPrototype(this, Constructor.prototype)
          */</span>
          instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> instance<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> w3 <span class="token operator">=</span> <span class="token function">createSimpleClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="4"><li><p>函数运用</p> <p>函数式（高阶函数，curry化，compose,其他）</p> <p>函数式 完成函数功能上具体化，可伸展化，灵活，编写简答化</p> <p>高阶函数，以函数为返回，或者作为参数</p> <p>curry化，以缩小一个函数的功能化范围，多次产生根据参数所决定的功能，反柯理化完成功能范围扩大化，
对操作对象实现更大使用范围上的扩张</p> <p>compose 完成流程上了控制，实现类似流自动话函数执行</p></li> <li><p>AST语法树
语法树，完成对基本语言原生语法的对象话转换，在转换过程中更好的理解原生语言的特性，关系，
方便最终转化目标的更好的理解过程，主要协助代码转换编译过程</p></li></ol></li> <li><p>js中编程</p> <p>深拷贝: 完成将对象都以基本类型拷贝来完成，不产生地址上的关联
通过递归方式来遍历对象完成,在某些情况下JSON.stringify可以完成深度拷贝，但不全面</p> <p>浅拷贝: 对有对象引用的不做去除关联拷贝，而是直接拷贝，修改有影响
（Object.assign, ...,）</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">deepObject</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> checkWeakMap</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> obj <span class="token operator">!==</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token keyword">return</span> obj<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>obj instanceOf Date<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>obj instanceOf Regexp<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Regexp</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 防止出现循环引用</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>checkWeakMap<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> obj<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> weakMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  weakMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">obj<span class="token punctuation">.</span>constructor</span><span class="token punctuation">;</span>
  <span class="token comment">// 递归完成每一层的遍历</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    result<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">deepObject</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> weakMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li></ul> <h2 id="异步-事件环"><a href="#异步-事件环" class="header-anchor">#</a> 异步&amp;事件环</h2> <h3 id="一-promise"><a href="#一-promise" class="header-anchor">#</a> 一. promise</h3> <p>早期异步操作操作对于顺序执行控制，多个操作并发，异步错误处理，都只能通过回调方式来解决</p> <ul><li>优势</li></ul> <ol><li><p>解决异步回调嵌套过深问题</p></li> <li><p>多个异步操作并发处理</p></li> <li><p>异步错误处理的优化</p></li></ol> <ul><li>缺点</li></ul> <p>对于异步状态发生改变后，不能更改，并且对于发起异步操作后终止问题，不能一开始就阻止，只能通过丢弃忽略操作结果</p> <ul><li>原理剖析</li></ul> <ol><li><p>Promise以类的模式出现</p></li> <li><p>每一个promise有三种状态标识（resolve, reject, pending）,且若状态发生改变后不会再更改</p></li> <li><p>链式返回每一次promise对象都为一个新的promise对象</p></li> <li><p>返回值分为普通值(非promise对象的其他值类型)与promise对象模式，每一个返回值作为下一个promise的参数值传入</p></li> <li><p>错误处理的捕获不会阻断后续任务执行</p></li> <li><p>通过发布订阅方式完成触发</p></li></ol> <p>手写代码github：</p> <h3 id="二-iterator-generator"><a href="#二-iterator-generator" class="header-anchor">#</a> 二. iterator,generator</h3> <p>不管是遍历器，还是生成遍历方法，目的都是为了返回一个遍历对象，其内部有next方法，在遍历运算符调用时，会不停掉用内部next完成遍历，都是通过Symbol.iterator函数返回一个it对象</p> <ol><li>iterator</li></ol> <p>生成遍历器，主要的出现目的，也是为了解决数据对象的遍历统一，可以扩展遍历方式，对应扩展运算符，for of底层调用的都是通过次完成</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token comment">// 类数组对象具有length和key,本身不能调用扩展运算符来遍历的,返回一个有next方法的遍历器</span>
  <span class="token comment">// 且扩展运算循环内部会不断调next方法</span>
  <span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>length<span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  obj<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> index<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">next</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>value<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span> done<span class="token operator">:</span> index<span class="token operator">++</span> <span class="token operator">===</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>generator 生成遍历器</li></ol> <p>可以更加的灵活控制遍历，内部搭配方法yield具有阻断执行，因此可以更加灵活的对异步结果处理返回</p> <div class="language-js extra-class"><pre class="language-js"><code>  obj<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>index <span class="token operator">!=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">yield</span> <span class="token keyword">this</span><span class="token punctuation">[</span>index<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre></div><ol start="3"><li>co库</li></ol> <p>主要思想还是通过利用了generator的可阻断执行，来对异步操作的结果等拿到，再开启遍历将结果返回，形式上实现类似同步运行感，并通过外层返回promise对象，完成操作的扁平化，抛弃到嵌套方式回调结果，利用了promise的优势点</p> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token keyword">const</span> <span class="token function-variable function">read</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">const</span> c1 <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./1.txt'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">const</span> c2 <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./2.txt'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> c2<span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
 <span class="token keyword">const</span> <span class="token function-variable function">co</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">it</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">// 这里返回promise,解决嵌套异步问题</span>
   <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
     <span class="token keyword">function</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
       <span class="token comment">// 第一次执行第一条代码</span>
       <span class="token keyword">const</span> <span class="token punctuation">{</span>value<span class="token punctuation">,</span> done<span class="token punctuation">}</span> <span class="token operator">=</span> it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token comment">// 若还有遍历</span>
       <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>done<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token comment">// 将对象包装为promise,这样对每一个处理统一，如果抛错直接结束，外部可以更方便拿到</span>
         Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
           <span class="token function">next</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span><span class="token punctuation">,</span> reject<span class="token punctuation">)</span>
       <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
         <span class="token comment">// 当遍历完成value为最后的c2返回值</span>
         <span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
     <span class="token comment">// 实现遍历控制</span>
     <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
 <span class="token function">co</span><span class="token punctuation">(</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> d<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="4"><li>async,await</li></ol> <p>内部原理其实就是generator + co实现，完成更加遍历的使用，async await 替换掉了generator 和 co 默认async 函数执行后返回的就是一个promise</p> <h3 id="异步"><a href="#异步" class="header-anchor">#</a> 异步</h3> <p>计算机对任务的执行以进程为单位基础分配内存，所以一个进程完成一个主任务</p> <ul><li>浏览器</li></ul> <p>浏览器是一个多进程运行（浏览器第三方插件进程管理，网络请求进程，GPU3D动画渲染，用户界面控制进程），每一个页卡都是一个新的主进程，互不影响，（渲染进程）。</p> <p>渲染进程包括：js引擎线程，gui渲染（UI渲染）线程，event loop循环事件进程，第三方各api异步线程(ajax, setTimeout, setInterval，setImmidate,click等)</p> <p>js线程与ui线程为互斥线程，不会同时进行，主要保证操作的健壮性，event loop事件线程完成异步任务的调度进入主运行线程，第三方异步线程提供了各种异步执行方法运行环境。</p> <p>对于js的执行理解，同步任务，异步任务，同步任务即可以按常规流程执行并完成，异步任务分（宏任务，微任务），宏任务以（script, ui渲染（此流程会优化性频繁操作问题）, requestAnimation,setTimeout, setImmidate,setInterval, click, channelMessage）,微任务（promise, mutationObserver, nextTick）,总流程为脚本主宏任务任务，在执行过程中，同步代码先完成执行，若遇到异步任务，对应放入异步任务队列(宏任务队列，微任务队列)，注意宏任务放入宏任务队列是在执行到时才放入，微任务是直接放入，同步执行完对应清空微任务，之后UI渲染，再通过event loop调度去下一个宏任务进入主线程，反复此流程</p> <ul><li>node</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.a3423334.js" defer></script><script src="/blog/assets/js/2.a973bc12.js" defer></script><script src="/blog/assets/js/18.690ad6d6.js" defer></script>
  </body>
</html>
